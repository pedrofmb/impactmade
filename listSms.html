<!DOCTYPE html>
<html>
<head>

    <!-- Basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Medias | Porto - Responsive HTML5 Template 4.4.0</title>

    <meta name="keywords" content="HTML5 Template" />
    <meta name="description" content="Porto - Responsive HTML5 Template">
    <meta name="author" content="okler.net">

    <!-- Favicon -->
    <link rel="shortcut icon" href="img/logo-icon-trans2.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Web Fonts  -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800%7CShadows+Into+Light" rel="stylesheet" type="text/css">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.min.css">
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.theme.default.min.css">
    <link rel="stylesheet" href="vendor/magnific-popup/magnific-popup.min.css">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/theme-elements.css">
    <link rel="stylesheet" href="css/theme-blog.css">
    <link rel="stylesheet" href="css/theme-shop.css">
    <link rel="stylesheet" href="css/theme-animate.css">

    <!-- Skin CSS -->
    <link rel="stylesheet" href="css/skins/default.css">

    <!-- Theme Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">

    <!-- Head Libs -->
    <script src="vendor/modernizr/modernizr.min.js"></script>

</head>
<body>

    <div class="body">
        <header id="header" data-plugin-options='{"stickyEnabled": true, "stickyEnableOnBoxed": true, "stickyEnableOnMobile": true, "stickyStartAt": 57, "stickySetTop": "-57px", "stickyChangeLogo": true}'>
            <div class="header-body">
                <div class="header-container container">
                    <div class="header-row">
                        <div class="header-column">
                            <div class="header-logo">
                                <a href="index.html">
                                    <img alt="Porto" width="240" height="60" data-sticky-width="160" data-sticky-height="40" data-sticky-top="33" src="img/logo.png">
                                </a>
                            </div>
                        </div>
                        <div class="header-column">
                            <div class="header-row">
                                <nav class="header-nav-top">
                                    <ul class="nav nav-pills">
                                        <li class="hidden"><a href="login.html"><i class="fa fa-user"></i> Business login</a></li>
                                        <li class="hidden"><a href="login.html"><i class="fa fa-user"></i> Personal login</a></li>
                                        <li>
                                            <span class="ws-nowrap" style="color: black; font-size: 20px"><i class="fa fa-phone"></i> +1 855-804-0420</span>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                            <div class="header-row">
                                <div class="header-nav">
                                    <button class="btn header-btn-collapse-nav" data-toggle="collapse" data-target=".header-nav-main">
                                        <i class="fa fa-bars"></i>
                                    </button>
                                    <div class="header-nav-main header-nav-main-effect-1 header-nav-main-sub-effect-1 collapse">
                                        <nav>
                                            <ul class="nav nav-pills" id="mainNav">
                                                <li class="">
                                                    <a class="" href="dashboard.html">
                                                        Dashboard
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a class="" href="manage.html">
                                                        My numbers
                                                    </a>
                                                </li>
                                                <!--<li class="dropdown">
                        <a class="dropdown-toggle" href="" style="background-color: #0288CC;color: white;">
                            Manage
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="variablesAdmin.html" style="background-color: #0288CC;color: white;">Variables</a></li>
                            <li><a href="variablesAssign.html">Calls</a></li>
                        </ul>
                    </li>-->
                                                <li class="">
                                                    <a class="" href="variablesAdmin.html">
                                                        Variables Admin
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a class="" href="variablesAssign.html">
                                                        Manage Calls
                                                    </a>
                                                </li>
                                                <li class="">
                                                    <a class="" href="reports.html">
                                                        Reports
                                                    </a>
                                                </li>
                                                <li class="dropdown">
                                                    <a id="userTab" class="dropdown-toggle" href="">
                                                        User 01
                                                    </a>
                                                    <ul class="dropdown-menu">
                                                        <li><a href="myaccount.html">Account</a></li>
                                                        <li><a href="calendar.html">Calendar</a></li>
                                                        <!--<li><a href="billing.html">Billing</a></li>-->
                                                        <li><a href="javascript:Logout();">Logout</a></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </nav>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div role="main" class="main">

            <hr class="tall">
            <div class="container">
                <h2><b>SMS</b></h2>
                <div class="row">
                    <div class="col-md-12">
                        <div class="col-md-3">
                            <label>Start Date</label>
                            <input type="datetime-local" id="startDate" class="form-control input-lg mb-md">
                        </div>
                        <div class="col-md-3">
                            <label>End Date</label>
                            <input type="datetime-local" id="endDate" class="form-control input-lg mb-md">
                        </div>
                        <div class="col-md-3" id="divFrom">
                            <label>From</label>
                            <input type="text" id="from" placeholder="+19991234567" class="form-control input-lg mb-md">
                        </div>
                        <div class="col-md-3" id="divTo">
                            <label>To</label>
                            <input type="text" id="to" placeholder="+19991234567" class="form-control input-lg mb-md">
                        </div>
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a id="accordionListSms1" class="accordion-toggle" data-status="1" href="#ok">
                                            <i class="fa fa-comment"></i>
                                            List sms
                                        </a>
                                    </h4>
                                </div>
                                <!--la clase in a nivel del div con id="collapseOneSMS hace que se muestre el contenido-->
                                <div id="collapseListSms1" class="accordion-body collapse in">
                                    <div id="bodyListSms1" class="panel-body">
                                        <div class="col-md-12 align-center">
                                            <div class="col-md-12"  style="padding-top: 15px; padding-bottom: 20px">
                                                <div id="divIsIncoming" class="col-md-3">
                                                    <select id="selectIsIncoming" class="form-control input-lg mb-md">
                                                        <option value="0">Inbound/Outbound</option>
                                                        <option value="1">Outbound</option>
                                                        <option value="2">Inbound</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-3 pull-right" id="divFilter" style="margin-left: 30px">
                                                    <button id="buttonFilter" class="form-control input-lg mb-md" style="background-color: #0088cc; color: white">
                                                        Filter
                                                    </button>
                                                </div>
                                                <div id="divIsIncoming" class="col-md-3 input-group" style="margin-right: 0px">
                                                    <span class="input-group-btn">
                                                        <input type="text" class="form-control input-lg mb-md" id="textSearchSms1" placeholder="Search...">
                                                        <button id="buttonSearchSms1" class="btn btn-default" type="submit" style="width: 46px; height: 46px"><i class="fa fa-search"></i></button>
                                                    </span>
                                                </div>
                                            </div>
                                            <div id="tableSms1" class="align-center" style="padding-left: 20px">
                                                <table class="table table-bordered table-striped mb-none" id="datatable-Sms1">
                                                    <thead>
                                                        <tr>
                                                            <th class="align-center">Date</th>
                                                            <th class="align-center">Direction</th>
                                                            <th class="align-center">From</th>
                                                            <th class="align-center">To</th>
                                                            <th class="align-center">Body</th>
                                                            <th class="align-center">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="gradeX"></tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <ul id="paginationVoice" class="pagination center-block" style="padding-right: 25px; padding-bottom: 35px">
                                            <li id="liLeft" class="pull-left disabled" style="padding-left: 50px"><a href="#"><i class="fa fa-chevron-left"></i></a></li>
                                            <li id="liRight" class="pull-right" style="padding-right: 5px"><a href="#"><i class="fa fa-chevron-right"></i></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="row" id="contentModal"></div>
                            <!--<div class="modal fade" id="smallModal" tabindex="-1" role="dialog" aria-labelledby="smallModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-sm">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="smsTitle">
                                                
                                            </h4>
                                        </div>
                                        <div class="modal-body" id="smsBody">
                                            
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>-->
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <footer id="footer">
            <div class="container">
                <div class="row">
                    <div class="footer-ribbon">
                        <span>Get in Touch</span>
                    </div>
                    <div class="col-md-8">
                        <h4>About <strong>IM Cloud Communications</strong></h4>
                        <p style="width: 95%; text-align: justify;">Impact Made, LLC. delivers high-performance business phone systems and cloud services that are simple, intuitive and uniquely integrated, backed by its superior technical support and available in multiple deployment models. We believe that business doesn’t get done without communication. "Technology is everywhere, yet most users don’t leverage the full power of these solutions to drive business. Features and functions meant for productivity are simply too complicated and therefore go unused. Our focus is on making intelligent technology that is intuitive and easy to use, empowering employee productivity to fuel customer satisfaction."</p>
                        <hr class="tall" style="width: 95%;">
                    </div>
                    <div class="col-md-4">
                        <div class="contact-details">
                            <h4>Contact Us</h4>
                            <ul class="contact">
                                <li>
                                    <p>
                                        <i class="fa fa-map-marker"></i> <strong>Address:</strong> 304 Indian Trace #224 Weston, FL 33326, United States
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <i class="fa fa-phone"></i> <strong>Phone:</strong> +1 954-870-4665, Tool Free: +1 855-804-0420
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <i class="fa fa-envelope"></i> <strong>Email:</strong> <a href="mailto:mail@example.com"> info@impactmade.com</a>
                                    </p>
                                </li>
                            </ul>

                            <h4>Follow Us</h4>
                            <ul class="social-icons">
                                <li class="social-icons-facebook"><a href="https://www.facebook.com/" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></li>
                                <li class="social-icons-twitter"><a href="https://www.twitter.com/" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></li>
                                <li class="social-icons-linkedin"><a href="https://www.linkedin.com/" target="_blank" title="Linkedin"><i class="fa fa-linkedin"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-copyright">
                <div class="container">
                    <div class="row">
                        <div class="col-md-2">
                            <a href="index.html" class="logo">
                                <img alt="Porto Website Template" class="img-responsive" src="img/logo-footer.png">
                            </a>
                        </div>
                        <div class="col-md-4">
                            <p>© Copyright 2015. All Rights Reserved.</p>
                        </div>
                        <div class="col-md-6">
                            <nav id="sub-menu">
                                <ul>
                                    <!--<li><a href="about-us.html">About Us</a></li>-->
                                    <li><a href="terms.html">Terms & Conditions </a></li>
                                    <li><a href="privacy.html">Privacy Policy</a></li>
                                    <li><a href="faqIM.html">FAQ'S</a></li>
                                    <li><a href="contact-us.html">Contact Us</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>


    <!-- Vendor -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/jquery.appear/jquery.appear.min.js"></script>
    <script src="vendor/jquery.easing/jquery.easing.min.js"></script>
    <script src="vendor/jquery-cookie/jquery-cookie.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/common/common.min.js"></script>
    <script src="vendor/jquery.validation/jquery.validation.min.js"></script>
    <script src="vendor/jquery.stellar/jquery.stellar.min.js"></script>
    <script src="vendor/jquery.easy-pie-chart/jquery.easy-pie-chart.min.js"></script>
    <script src="vendor/jquery.gmap/jquery.gmap.min.js"></script>
    <script src="vendor/jquery.lazyload/jquery.lazyload.min.js"></script>
    <script src="vendor/isotope/jquery.isotope.min.js"></script>
    <script src="vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>
    <script src="vendor/vide/vide.min.js"></script>

    <!-- Theme Base, Components and Settings -->
    <script src="js/theme.js"></script>

    <!-- Theme Custom -->
    <script src="js/custom.js"></script>

    <!-- Theme Initialization Files -->
    <script src="js/theme.init.js"></script>

    <!-- Google Analytics: Change UA-XXXXX-X to be your site's ID. Go to http://www.google.com/analytics/ for more information.
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-12345678-1', 'auto');
        ga('send', 'pageview');
    </script>
     -->
    <!-- Funcionalidad del arbol -->
    <link rel="stylesheet" href="vendor/jqueryui/jquery-ui.min.css" />
    <script type="text/javascript" src="vendor/jqueryui/jquery-ui.min.js"></script>

    <link rel="stylesheet" href="css/toastr.min.css" />
    <link rel="stylesheet" href="css/bootstrap-treeview.min.css" />
    <link rel="stylesheet" href="css/bootstrap-tour.min.css" />

    <script type="text/javascript" src="js/toastr.min.js"></script>
    <script type="text/javascript" src="js/toaster_msgs.js"></script>

    <script type="text/javascript" src="js/tree-class.js"></script>
    <script type="text/javascript" src="js/structures.js"></script>
    <script type="text/javascript" src="js/jTreeUI/Treeview.js"></script>

    <script type="text/javascript" src="js/bootstrap-tour.min.js"></script>
    <script type="text/javascript" src="js/admin.js"></script>
    <script type="text/javascript" src="js/ajaxCore.js"></script>
    <script type="text/javascript" src="js/jTreeUI/im-tree-iu.js"></script>

    <script type="text/javascript">
        $(function () {
            
            $("#userTab").html("");
            $("#userTab").html(localStorage["email"]);

            var SIDCODE = localStorage["sid"];
            var numberPage = 0;
            var limitPage = 0;

            var monthToday;
            var dayToday;
            var dayYesterday;
            var dateToday = new Date();
            if ((dateToday.getMonth() + 1) < 10) {
                monthToday = "0" + (dateToday.getMonth() + 1);
            }
            else { monthToday = dateToday.getMonth() + 1 }
            if ((dateToday.getDate()) < 10) {
                dayToday = "0" + dateToday.getDate();
                dayYesterday = "0" + (dateToday.getDate()-1);
            }
            else { dayToday = dateToday.getDate(); dayYesterday = (dateToday.getDate() - 1); }
            var strToday = dateToday.getFullYear() + "-" + monthToday + "-" + dayToday;
            var strYesterday = dateToday.getFullYear() + "-" + monthToday + "-" + dayYesterday;
            $("#endDate").attr("max", strToday);
            $("#startDate").attr("max", strYesterday);

            function fillModalSms(str1, str2, urlList, index) {
                    var aux = str1 + "<br>" + str2;
                    $("#smsTitle" + index).append(aux);
                    for (var i = 0; i < urlList.length; i++) {
                        $("#smsBody" + index).append("url " + (i + 1) + ": <a target='_blank' href=" + urlList[i] + ">" + urlList[i] + "</a><br>");
                    }
            }

            function fillTableSms(page) {
                var key = true;
                var startDate = new Date($("#startDate").val());
                startDate = startDate.toISOString();
                var endDate = new Date($("#endDate").val());
                endDate = endDate.toISOString();
                $("#datatable-Sms1 tbody").html("");
                $("#contentModal").html("");
                var filtIs = null;
                var aux;
                var textFind = $("#textSearchSms1").val();
                if(textFind == ""){
                    textFind = null;
                }

                aux = $("#selectIsIncoming").val();
                if (aux == 2) {
                    filtIs = true;
                } if (aux == 1) {
                    filtIs = false;
                }
                var filtFrom = null;
                var filtTo = null;

                var aux = $("#from").val();
                if (aux.length != 0) {
                    if (aux.length != 12) {
                        key = false;
                        alert("the FROM field is wrong, write again...");
                        $("#from").val("");
                        $("#from").focus();
                    }
                    if (aux.lenght == 12) {
                        filtFrom = aux;
                    }
                }

                aux = $("#to").val();
                if (aux.length != 0) {
                    if (aux.length != 12) {
                        key = false;
                        alert("the TO field is wrong, write again...");
                        $("#to").val("");
                        $("#to").focus();
                    }
                    if (aux.lenght == 12) {
                        filtTo = aux;
                    }
                }
                
                if(key){
                    $("#datatable-Sms1 tbody").html("");
                    $("#contentModal").html("");
                    Services.Local.ListSms(SIDCODE, startDate, endDate, page, filtFrom, filtTo, textFind, filtIs, function (result, textStatus, xhr) {
                        limitPage = xhr.getResponseHeader("x-pages");
                        alert(limitPage);
                        var hour, aux;
                        for (var i = 0; i < result.length; i++) {
                            hour = result[i].Date.split("T");
                            aux = hour[1].substring(0, 8) + "<br>" + hour[0];
                            $("#contentModal").append(
                                "<div class='modal fade' id='smallModal" + (i + 1) + "' tabindex='-1' role='dialog' aria-labelledby='smallModalLabel' aria-hidden='true'><div class='modal-dialog modal-sm'><div class='modal-content'><div class='modal-header'><button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button><h4 class='modal-title' id='smsTitle" + (i + 1) + "'></h4></div><div class='modal-body' id='smsBody" + (i + 1) + "'>				</div><div class='modal-footer'><button type='button' class='btn btn-default' data-dismiss='modal'>Close</button></div></div></div></div>"
                                );
                            if (result[i].IsIncoming == true || result[i].IsIncoming == null) {
                                if(result[i].Media.length == 0){
                                    $("#datatable-Sms1 tbody").append("<tr val=" + result[i].Sid + "><td style='color: #0088cc'>" + aux + "</td><td>Inbound</td><td>" + result[i].From + "</td><td>" + result[i].To + "</td><td>" + result[i].Body + "</td><td class='actions align-center'><a><i class='fa fa-close'></i></a></td></tr>");
                                }
                                else {
                                    $("#datatable-Sms1 tbody").append("<tr val=" + result[i].Sid + "><td style='color: #0088cc'>" + aux + "</td><td>Inbound</td><td>" + result[i].From + "</td><td>" + result[i].To + "</td><td>" + result[i].Body + "</td><td class='actions align-center'><a data-toggle='modal' href='#' onclick=" + fillModalSms(hour[1].substring(0, 8), hour[0], result[i].Media, ((50 * numberPage) + (i + 1))) + " data-target='#smallModal" + (i + 1) + "'><i class='fa fa-envelope-o'></i></a></td></tr>");
                                }
                            }
                            if (result[i].IsIncoming == false || result[i].IsIncoming == null) {
                                if (result[i].Media.length == 0) {
                                    $("#datatable-Sms1 tbody").append("<tr val=" + result[i].Sid + "><td style='color: #0088cc'>" + aux + "</td><td>Outbound</td><td>" + result[i].From + "</td><td>" + result[i].To + "</td><td>" + result[i].Body + "</td><td class='actions align-center'><a><i class='fa fa-close'></i></a></td></tr>");
                                }
                                else {
                                    $("#datatable-Sms1 tbody").append("<tr val=" + result[i].Sid + "><td style='color: #0088cc'>" + aux + "</td><td>Outbound</td><td>" + result[i].From + "</td><td>" + result[i].To + "</td><td>" + result[i].Body + "</td><td class='actions align-center'><a data-toggle='modal' href='#' onclick=" + fillModalSms(hour[1].substring(0, 8), hour[0], result[i].Media, ((50 * numberPage) + (i + 1))) + " data-target='#smallModal" + (i + 1) + "'><i class='fa fa-envelope-o'></i></a></td></tr>");
                                }
                            }
                        }
                    }, function (error) { alert("error listing the sms") });
                }
            }
            

            $("#buttonFilter").click(function (event) {
                numberPage = 0;
                fillTableSms(numberPage);
            });

            $("#buttonSearchSms1").click(function (event) {
                var textFind = $("#textSearchSms1").val();
                if (textFind != "") {
                    numberPage = 0;
                    fillTableSms(numberPage);
                }
                else { alert("Please, fill the field");}
            });

            $("#liLeft").click(function (event) {
                if (numberPage > 0) {
                    numberPage--;
                    fillTableSms(numberPage);
                    $("#liLeft").removeClass("disabled");
                    $("#liRight").removeClass("disabled");
                } else {
                    $("#liLeft").addClass("disabled");
                }
            });

            $("#liRight").click(function (event) {
                numberPage++;
                if (limitPage > numberPage) {
                    fillTableSms(numberPage);
                    $("#liLeft").removeClass("disabled");
                    $("#liRight").removeClass("disabled");
                } else {
                    alert("no more messages to list");
                    $("#liRight").addClass("disabled");
                }
            });

        });
    </script>

</body>
</html>